<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE jasperReport PUBLIC "//JasperReports//DTD Report Design//EN" "http://jasperreports.sourceforge.net/dtds/jasperreport.dtd">
<jasperReport 
		 name="ShipmentInvoice"
		 columnCount="1"
		 printOrder="Vertical"
		 orientation="Portrait"
		 pageWidth="612"
		 pageHeight="792"
		 columnWidth="576"
		 columnSpacing="0"
		 leftMargin="18"
		 rightMargin="18"
		 topMargin="18"
		 bottomMargin="18"
		 whenNoDataType="NoPages"
		 scriptletClass="edu.harvard.huh.specify.config.HUHScriptlet"
		 isTitleNewPage="false"
		 isSummaryNewPage="false">
    <property name="ireport.scriptlethandling" value="0"/>
	<property name="ireport.encoding" value="UTF-8"/>
	<import value="java.util.*"/>
	<import value="net.sf.jasperreports.engine.*"/>
	<import value="net.sf.jasperreports.engine.data.*"/>
	<parameter name="itemnum" class="java.lang.String" isForPrompting="false"/>
	<parameter name="RPT_IMAGE_DIR" class="java.lang.String" isForPrompting="false"/>
	<parameter name="SUBREPORT_DIR" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["/Users/dtremonte/Desktop/workspace/specify-asaimport/config/botany"]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[select shipment.NumberOfPackages as numberOfPackages,
	                shipment.ShipmentNumber   as shipmentNumber,
                    shipment.ShipmentMethod   as shipmentMethod,
                    shipment.ShipmentDate     as shipmentDate,
                    shipment.ShippedToID      as shippedToID,

       (select Title from picklistitem where Value=shippedto.Title and PickListID=
         (select PickListID from picklist where Name="AgentTitles")) as shippedtoTitle,

       shippedto.FirstName as shippedToFirstName,
       shippedto.Initials  as shippedToMiddleInitial,
       shippedto.LastName  as shippedToLastName,
       shippedto.JobTitle  as shippedToJobTitle,

       shipaddr.Address     as shipaddrAddress,
       shipaddr.Address2    as shipaddrAddress2,
       shipaddr.City        as shipaddrCity,
       shipaddr.State       as shipaddrState,
       shipaddr.PostalCode  as shipaddrPostalCode,
       shipaddr.Country     as shipaddrCountry,

       preparer.FirstName as preparerFirstName,
       preparer.LastName  as preparerLastName,

       transaction.TransactionID as transactionID,
       transaction.Type          as transactionType

from shipment
     left join agent shippedto on shipment.ShippedToID=shippedto.AgentID
     left join (select * from address where IsShipping=true) shipaddr on shippedto.AgentID=shipaddr.AgentID
     left join agent preparer on shipment.ShippedByID=preparer.AgentID
     left join ((select eo.ExchangeOutID as TransactionID, "ExchangeOut" as Type from exchangeout eo) union
                (select g.GiftID as TransactionID, "Gift" as Type from gift g) union
                (select l.LoanID as TransactionID, "Loan" as Type from loan l)) transaction
                on ((transaction.TransactionID=shipment.ExchangeOutID and transaction.Type="ExchangeOut") or
                    (transaction.TransactionID=shipment.GiftID and transaction.Type="Gift") or
                    (transaction.TransactionID=shipment.LoanID and transaction.Type="Loan"))

where shipment.ShipmentID $P!{itemnum}]]>
	</queryString>
	<field name="numberOfPackages" class="java.lang.Integer"/>
	<field name="preparerLastName" class="java.lang.String"/>
	<field name="preparerFirstName" class="java.lang.String"/>
	<field name="shipaddrAddress" class="java.lang.String"/>
	<field name="shipaddrAddress2" class="java.lang.String"/>
	<field name="shipaddrCity" class="java.lang.String"/>
	<field name="shipaddrState" class="java.lang.String"/>
	<field name="shipaddrPostalCode" class="java.lang.String"/>
	<field name="shipaddrCountry" class="java.lang.String"/>
	<field name="shipmentDate" class="java.sql.Date"/>
	<field name="shipmentMethod" class="java.lang.String"/>
	<field name="shipmentNumber" class="java.lang.String"/>
	<field name="shippedtoFirstName" class="java.lang.String"/>
	<field name="shippedtoJobTitle" class="java.lang.String"/>
	<field name="shippedtoLastName" class="java.lang.String"/>
	<field name="shippedtoMiddleInitial" class="java.lang.String"/>
	<field name="shippedtoTitle" class="java.lang.String"/>
	<field name="transactionID" class="java.lang.Long"/>
	<field name="transactionType" class="java.lang.String"/>
	<variable name="itemsLoan" class="java.lang.Integer" calculation="Sum"/>
	<variable name="nonSpecimensLoan" class="java.lang.Integer" calculation="Sum"/>
	<variable name="typesLoan" class="java.lang.Integer" calculation="Sum"/>
	<variable name="itemsGift" class="java.lang.Integer" calculation="Sum"/>
	<variable name="nonSpecimensGift" class="java.lang.Integer" calculation="Sum"/>
	<variable name="typesGift" class="java.lang.Integer" calculation="Sum"/>
	<variable name="itemsExch" class="java.lang.Integer" calculation="Sum"/>
	<variable name="nonSpecimensExch" class="java.lang.Integer" calculation="Sum"/>
	<variable name="typesExch" class="java.lang.Integer" calculation="Sum"/>
	<background>
		<band isSplitAllowed="true"/>
	</background>
	<title>
		<band height="295" isSplitAllowed="true">
			<rectangle>
				<reportElement key="rectangle-1" mode="Transparent" x="387" y="8" width="185" height="44"/>
			</rectangle>
			<textField isBlankWhenNull="false">
				<reportElement key="textField" x="474" y="15" width="98" height="20"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Serif" size="12" isBold="true" isUnderline="false" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{shipmentNumber}]]></textFieldExpression>
			</textField>
			<textField pattern="yyyy/MM/dd" isBlankWhenNull="false">
				<reportElement key="textField" x="445" y="123" width="123" height="18"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Serif" size="12"/>
				</textElement>
				<textFieldExpression class="java.util.Date"><![CDATA[$F{shipmentDate}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="false">
				<reportElement key="textField" x="445" y="94" width="123" height="15"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Serif" size="12"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{shipmentMethod}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement key="staticText-10" x="4" y="110" width="18" height="13"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font size="10" isBold="false" pdfFontName="Helvetica"/>
				</textElement>
				<text><![CDATA[To:]]></text>
			</staticText>
			<textField isBlankWhenNull="false">
				<reportElement key="textField" x="22" y="110" width="142" height="13"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[((edu.harvard.huh.specify.config.HUHScriptlet)$P{REPORT_SCRIPTLET}).buildNameString($F{shippedtoTitle}, $F{shippedtoFirstName}, $F{shippedtoLastName}, $F{shippedtoMiddleInitial})]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement key="textField" x="22" y="123" width="100" height="13"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{shipaddrAddress}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement key="textField" x="22" y="136" width="100" height="13"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{shipaddrAddress2}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement key="textField" x="22" y="149" width="70" height="13"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{shipaddrCity} + ","]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement key="textField" x="92" y="149" width="100" height="13"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{shipaddrState}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement key="textField" x="22" y="162" width="100" height="13"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{shipaddrPostalCode}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement key="textField" x="22" y="175" width="100" height="13"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{shipaddrCountry}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="false">
				<reportElement key="textField-4" x="445" y="76" width="123" height="13"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement>
					<font fontName="Serif" size="12"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[((edu.harvard.huh.specify.config.HUHScriptlet)$P{REPORT_SCRIPTLET}).buildNameString($F{preparerFirstName}, $F{preparerLastName}, "")]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement key="staticText" x="340" y="93" width="100" height="20"/>
				<textElement textAlignment="Right" markup="none">
					<font fontName="Serif" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Mode of shipment:]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText" x="330" y="192" width="238" height="27"/>
				<textElement markup="none">
					<font fontName="Serif" size="11" isBold="true"/>
				</textElement>
				<text><![CDATA[Requests for loan extensions should be made to Dr. James Macklin and/or HUHrequests]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText" x="174" y="0" width="225" height="23"/>
				<textElement textAlignment="Center" markup="none">
					<font size="12" isBold="true" isUnderline="true"/>
				</textElement>
				<text><![CDATA[INVOICE OF SPECIMENS]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText" x="174" y="16" width="225" height="55"/>
				<textElement textAlignment="Center" markup="none">
					<font fontName="Serif" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Harvard University Herbaria
22 Divinity Avenue
Cambridge, MA 02138
U.S.A.]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText" x="330" y="219" width="238" height="27"/>
				<textElement markup="none">
					<font fontName="Serif" size="11" isBold="true"/>
				</textElement>
				<text><![CDATA[Email: jmacklin@oeb.harvard.edu; HUHrequests@oeb.harvard.edu]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText" x="340" y="79" width="100" height="20"/>
				<textElement textAlignment="Right" markup="none">
					<font fontName="Serif" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Prepared by:]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText" x="391" y="36" width="118" height="20"/>
				<textElement markup="none">
					<font fontName="Serif" size="12"/>
				</textElement>
				<text><![CDATA[CITES Code:   US 004]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText" x="312" y="108" width="128" height="20"/>
				<textElement textAlignment="Right" markup="none">
					<font fontName="Serif" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Number of packages:]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText" x="330" y="154" width="100" height="20"/>
				<textElement markup="none">
					<font fontName="Serif" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Term of loan:]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText" x="340" y="123" width="100" height="20"/>
				<textElement textAlignment="Right">
					<font fontName="Serif" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Date prepared:]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText" x="391" y="15" width="92" height="19"/>
				<textElement markup="none">
					<font fontName="Serif" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Loan Number:]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText" x="330" y="172" width="100" height="20"/>
				<textElement markup="none">
					<font fontName="Serif" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Loan due date:]]></text>
			</staticText>
			<image>
				<reportElement key="image-1" x="0" y="0" width="100" height="100"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<imageExpression class="java.lang.String"><![CDATA[$P{RPT_IMAGE_DIR} + "/huh_logo_bw_100.png"]]></imageExpression>
			</image>
			<rectangle>
				<reportElement key="rectangle-1" mode="Transparent" x="324" y="149" width="244" height="97"/>
			</rectangle>
			<staticText>
				<reportElement x="22" y="234" width="210" height="12"/>
				<textElement>
					<font fontName="Serif"/>
				</textElement>
				<text><![CDATA[1) Please verify contents of package]]></text>
			</staticText>
			<staticText>
				<reportElement x="22" y="222" width="127" height="12"/>
				<textElement>
					<font fontName="Serif"/>
				</textElement>
				<text><![CDATA[Upon arrival of shipment:]]></text>
			</staticText>
			<staticText>
				<reportElement x="22" y="267" width="210" height="21"/>
				<textElement>
					<font fontName="Serif"/>
				</textElement>
				<text><![CDATA[3) Please return all shipments to us by trackable mail when possible.]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Transparent" x="20" y="202" width="100" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="SansSerif" size="10" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="Helvetica-Oblique" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
				</textElement>
				<text><![CDATA[Instructions]]></text>
			</staticText>
			<staticText>
				<reportElement x="22" y="246" width="210" height="26"/>
				<textElement>
					<font fontName="Serif"/>
				</textElement>
				<text><![CDATA[2) Sign copy 1 of the invoice and return to us at the address above.]]></text>
			</staticText>
			<line>
				<reportElement key="line-5" x="388" y="33" width="183" height="1"/>
				<graphicElement>
					<pen lineWidth="0.5" lineStyle="Solid"/>
				</graphicElement>
			</line>
			<textField evaluationTime="Report">
				<reportElement x="445" y="108" width="100" height="20"/>
				<textElement/>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$F{numberOfPackages}]]></textFieldExpression>
			</textField>
		</band>
	</title>
	<pageHeader>
		<band height="29" isSplitAllowed="true">
			<staticText>
				<reportElement x="5" y="8" width="567" height="18"/>
				<textElement>
					<font fontName="Serif" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Transaction         Collection               Taxon                          Comments                   # of spec.                   Received   ]]></text>
			</staticText>
			<line>
				<reportElement x="8" y="24" width="563" height="2"/>
			</line>
			<line>
				<reportElement key="line-5" x="5" y="2" width="567" height="2"/>
				<graphicElement>
					<pen lineWidth="0.5" lineStyle="Solid"/>
				</graphicElement>
			</line>
		</band>
	</pageHeader>
	<columnHeader>
		<band height="9" isSplitAllowed="true">
			<line>
				<reportElement key="line-6" x="0" y="0" width="575" height="1"/>
			</line>
		</band>
	</columnHeader>
	<detail>
		<band height="25" isSplitAllowed="true">
			<subreport isUsingCache="true">
				<reportElement key="subreport-1" positionType="Float" x="1" y="1" width="549" height="20" isRemoveLineWhenBlank="true"/>
				<subreportParameter name="itemnum">
					<subreportParameterExpression><![CDATA[$F{transactionID}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="SUBREPORT_DIR">
					<subreportParameterExpression><![CDATA[$P{SUBREPORT_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<returnValue subreportVariable="items" toVariable="itemsLoan"/>
				<returnValue subreportVariable="nonSpecimens" toVariable="nonSpecimensLoan"/>
				<returnValue subreportVariable="types" toVariable="typesLoan"/>
				<subreportExpression class="java.lang.String"><![CDATA[$P{SUBREPORT_DIR} + "botany_" + $F{transactionType} + "Invoice_subreport.jasper"]]></subreportExpression>
			</subreport>
		</band>
	</detail>
	<columnFooter>
		<band isSplitAllowed="true"/>
	</columnFooter>
	<pageFooter>
		<band height="70" isSplitAllowed="true">
			<elementGroup>
				<line>
					<reportElement key="line-1" x="-1" y="18" width="552" height="1"/>
				</line>
				<staticText>
					<reportElement key="staticText-15" x="4" y="1" width="92" height="15"/>
					<box>
						<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement>
						<font size="9"/>
					</textElement>
					<text><![CDATA[Loan comments:]]></text>
				</staticText>
				<textField evaluationTime="Auto" isBlankWhenNull="false">
					<reportElement key="textField-1" x="58" y="20" width="157" height="16"/>
					<box>
						<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement>
						<font isBold="false" pdfFontName="Helvetica"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA["Total Number of Specimens = " + $V{itemsLoan} + $V{itemsLoan} + $V{itemsExch}]]></textFieldExpression>
				</textField>
				<textField evaluationTime="Report" isBlankWhenNull="false">
					<reportElement key="textField-2" x="309" y="20" width="200" height="14"/>
					<box>
						<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement>
						<font size="10" isBold="false" pdfFontName="Helvetica"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA["Total Number of Types = " + $V{typesLoan} + $V{typesGift} + $V{typesExch}]]></textFieldExpression>
				</textField>
			</elementGroup>
			<textField>
				<reportElement x="438" y="45" width="80" height="20"/>
				<textElement textAlignment="Right"/>
				<textFieldExpression class="java.lang.String"><![CDATA["Page "+$V{PAGE_NUMBER}+" of"]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement x="518" y="45" width="40" height="20"/>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
	<lastPageFooter>
		<band height="194" isSplitAllowed="true">
			<staticText>
				<reportElement x="165" y="109" width="100" height="20"/>
				<textElement>
					<font fontName="Serif" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Signed]]></text>
			</staticText>
			<staticText>
				<reportElement x="15" y="38" width="433" height="25"/>
				<textElement>
					<font fontName="Serif" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Please acknowledge receipt of this loan by signing this copy of the invoice on the line below and returning it to us at the above address.]]></text>
			</staticText>
			<textField>
				<reportElement x="438" y="159" width="80" height="20"/>
				<textElement textAlignment="Right"/>
				<textFieldExpression class="java.lang.String"><![CDATA["Page "+$V{PAGE_NUMBER}+" of"]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="432" y="109" width="100" height="20"/>
				<textElement>
					<font fontName="Serif" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Date]]></text>
			</staticText>
			<line>
				<reportElement x="156" y="106" width="263" height="1"/>
			</line>
			<line>
				<reportElement x="424" y="106" width="119" height="1"/>
			</line>
			<staticText>
				<reportElement x="345" y="10" width="112" height="16"/>
				<textElement>
					<font fontName="Serif" size="14" isBold="true"/>
				</textElement>
				<text><![CDATA[Total specimens: ]]></text>
			</staticText>
			<rectangle>
				<reportElement x="469" y="11" width="39" height="15"/>
			</rectangle>
			<textField evaluationTime="Report">
				<reportElement x="518" y="159" width="40" height="20"/>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="15" y="71" width="324" height="20"/>
				<textElement>
					<font fontName="Serif" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Received in good order except as noted.]]></text>
			</staticText>
			<staticText>
				<reportElement x="21" y="160" width="189" height="20"/>
				<textElement>
					<font size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[Sign as indicated above]]></text>
			</staticText>
			<line>
				<reportElement x="10" y="156" width="549" height="1"/>
			</line>
		</band>
	</lastPageFooter>
	<summary>
		<band isSplitAllowed="true"/>
	</summary>
</jasperReport>
